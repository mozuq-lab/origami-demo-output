# F-006 退会 テストケース

## 基本情報

| 項目 | 内容 |
|------|------|
| 機能ID | F-006 |
| 機能名 | 退会 |
| 入力ファイル | 01_機能詳細.md / 02_動作仕様.md / 03_境界値分析.md |

---

## テストケース一覧

### TC-006-01: 新規登録ユーザーのマイページに退会ボタンが表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-01 |
| テスト種別 | 正常系 |
| 対応仕様 | M-001-01, M-001-02, M-001-03 |
| 境界値 | BV-001-01 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである

**When（実行条件）:**

1. マイページ（mypage.html）を表示する

**Then（期待結果）:**

- [ ] 「退会する」ボタンが表示されること
- [ ] ボタンが赤色（btn-danger）スタイルで表示されること
- [ ] ボタンが有効状態（クリック可能）であること

---

### TC-006-02: 「退会する」ボタンクリックで確認ダイアログが表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-02 |
| テスト種別 | 正常系 |
| 対応仕様 | M-002-01, M-002-02, M-002-03 |
| 境界値 | BV-002-01（ダイアログ表示の確認） |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- マイページを表示している

**When（実行条件）:**

1. 「退会する」ボタンをクリックする

**Then（期待結果）:**

- [ ] ブラウザの確認ダイアログが表示されること
- [ ] ダイアログに「退会すると全ての情報が削除されます。よろしいですか？」というメッセージが表示されること
- [ ] OKとキャンセルのボタンが表示されること

---

### TC-006-03: 確認ダイアログでOKを選択すると退会処理が実行されること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-03 |
| テスト種別 | 正常系 |
| 対応仕様 | M-003-01, M-003-02, M-003-03, M-003-04, M-003-05 |
| 境界値 | BV-002-01, BV-003-02, BV-003-04 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- マイページを表示している
- 確認ダイアログが表示されている

**When（実行条件）:**

1. 確認ダイアログで「OK」を選択する

**Then（期待結果）:**

- [ ] 完了メッセージ「退会処理を完了しました。ご利用ありがとうございました。」が表示されること
- [ ] 完了メッセージ確認後にトップページ（index.html）へ遷移すること
- [ ] トップページが未ログイン状態で表示されること

---

### TC-006-04: 退会後にLocalStorageからユーザーデータが削除されていること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-04 |
| テスト種別 | 正常系（データ検証） |
| 対応仕様 | M-003-02, N-003-01 |
| 境界値 | BV-003-02 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- 退会処理を完了した直後である（TC-006-03の続き）

**When（実行条件）:**

1. ブラウザのDevToolsでLocalStorageを確認する

**Then（期待結果）:**

- [ ] LocalStorageに退会したユーザーのメールアドレスをキーとするデータが存在しないこと

---

### TC-006-05: 退会後にセッションクッキーが削除されていること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-05 |
| テスト種別 | 正常系（データ検証） |
| 対応仕様 | M-003-01, N-003-02 |
| 境界値 | BV-003-04 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- 退会処理を完了した直後である

**When（実行条件）:**

1. ブラウザのDevToolsでCookieを確認する

**Then（期待結果）:**

- [ ] `session` クッキーが削除または無効化されていること（max-age=0または存在しない）

---

### TC-006-06: 退会後に同じメールアドレスでログインできないこと

| 項目 | 内容 |
|------|------|
| テストID | TC-006-06 |
| テスト種別 | 異常系 |
| 対応仕様 | N-003-03 |
| 境界値 | BV-005-01 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとして退会処理を完了済みである
- トップページ（未ログイン状態）を表示している

**When（実行条件）:**

1. ログインページ（login.html）へ移動する
2. 退会前に使用していたメールアドレスとパスワードを入力する
3. ログインボタンをクリックする

**Then（期待結果）:**

- [ ] ログインに失敗すること（アカウントが存在しないため）
- [ ] エラーメッセージが表示されること

---

### TC-006-07: 確認ダイアログでキャンセルを選択すると退会処理が実行されないこと

| 項目 | 内容 |
|------|------|
| テストID | TC-006-07 |
| テスト種別 | 正常系（中止操作） |
| 対応仕様 | M-004-01, M-004-02, N-002-02 |
| 境界値 | BV-002-02 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- マイページを表示している
- 確認ダイアログが表示されている

**When（実行条件）:**

1. 確認ダイアログで「キャンセル」を選択する

**Then（期待結果）:**

- [ ] ページ遷移が発生しないこと（マイページに留まること）
- [ ] 完了メッセージが表示されないこと

---

### TC-006-08: キャンセル後もLocalStorageのユーザーデータが保持されていること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-08 |
| テスト種別 | 正常系（データ検証） |
| 対応仕様 | M-004-03, N-004-01 |
| 境界値 | BV-004-01 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- 確認ダイアログでキャンセルを選択した直後である

**When（実行条件）:**

1. ブラウザのDevToolsでLocalStorageを確認する

**Then（期待結果）:**

- [ ] LocalStorageにユーザーデータが引き続き存在すること
- [ ] ログイン状態が維持されていること

---

### TC-006-09: キャンセル後もセッションクッキーが有効であること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-09 |
| テスト種別 | 正常系（データ検証） |
| 対応仕様 | M-004-04, N-004-02 |
| 境界値 | BV-004-02 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- 確認ダイアログでキャンセルを選択した直後である

**When（実行条件）:**

1. ブラウザのDevToolsでCookieを確認する

**Then（期待結果）:**

- [ ] `session` クッキーが引き続き有効であること（メールアドレスが設定されている）

---

### TC-006-10: ichiro（プリセットユーザー）の退会ボタンがdisabledであること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-10 |
| テスト種別 | 異常系（アクセス制限） |
| 対応仕様 | N-001-01, N-001-02 |
| 境界値 | BV-001-02 |
| 信号 | 🟢 |

**Given（前提条件）:**

- ichiro（メールアドレス: ichiro@example.com）としてログイン済みである

**When（実行条件）:**

1. マイページ（mypage.html）を表示する

**Then（期待結果）:**

- [ ] 「退会する」ボタンが表示されること
- [ ] ボタンが `disabled` 状態（操作不可）であること
- [ ] ボタンがクリックできないこと

---

### TC-006-11: sakura（プリセットユーザー）の退会ボタンがdisabledであること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-11 |
| テスト種別 | 異常系（アクセス制限） |
| 対応仕様 | N-001-01, N-001-02 |
| 境界値 | BV-001-03 |
| 信号 | 🟢 |

**Given（前提条件）:**

- sakura（メールアドレス: sakura@example.com）としてログイン済みである

**When（実行条件）:**

1. マイページ（mypage.html）を表示する

**Then（期待結果）:**

- [ ] 「退会する」ボタンが `disabled` 状態であること

---

### TC-006-12: 未ログイン状態でマイページにアクセスするとトップページへリダイレクトされること

| 項目 | 内容 |
|------|------|
| テストID | TC-006-12 |
| テスト種別 | 異常系（アクセス制御） |
| 対応仕様 | M-005-01 |
| 境界値 | BV-001-06 |
| 信号 | 🟢 |

**Given（前提条件）:**

- ログインしていない状態である

**When（実行条件）:**

1. マイページのURL（mypage.html）に直接アクセスする

**Then（期待結果）:**

- [ ] トップページ（index.html）へリダイレクトされること
- [ ] マイページが表示されないこと

---

### TC-006-13: 退会ボタンをクリックしても確認ダイアログなしに退会処理が実行されないこと

| 項目 | 内容 |
|------|------|
| テストID | TC-006-13 |
| テスト種別 | 正常系（フロー確認） |
| 対応仕様 | N-002-01 |
| 信号 | 🟢 |

**Given（前提条件）:**

- 新規登録ユーザーとしてログイン済みである
- マイページを表示している

**When（実行条件）:**

1. 「退会する」ボタンをクリックする

**Then（期待結果）:**

- [ ] 確認ダイアログが必ず表示されること
- [ ] 確認ダイアログが表示される前にページ遷移やデータ削除が発生しないこと

---

## 信号サマリー

| 信号 | 件数 | 内容 |
|------|------|------|
| 🟢 | 13 | 全テストケース（退会ボタン表示、確認ダイアログ、OK時退会処理、データ削除検証、退会後ログイン不可、キャンセル時動作、データ保持検証、プリセットユーザー制限2件、未ログインリダイレクト、確認ダイアログ必須） |
| 🟡 | 0 | - |
| 🔴 | 0 | - |

---

## テストケース数

**合計: 13件（🟢: 13件 / 🟡: 0件 / 🔴: 0件）**
