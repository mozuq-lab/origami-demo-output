# F-006 退会 動作仕様

## 基本情報

| 項目 | 内容 |
|------|------|
| 機能ID | F-006 |
| 機能名 | 退会 |
| 入力ファイル | 01_機能詳細.md |

---

## Must（できなければならない）

### M-001: 退会ボタンの表示

| No | 項目 | 信頼性 |
|----|------|--------|
| M-001-01 | マイページに「退会する」ボタンが表示されること | 🟢 |
| M-001-02 | 退会ボタンがBootstrap btn-danger（赤色）スタイルで表示されること | 🟢 |
| M-001-03 | 新規登録ユーザーがログインしている場合、退会ボタンが有効（クリック可能）状態であること | 🟢 |

### M-002: 確認ダイアログの表示

| No | 項目 | 信頼性 |
|----|------|--------|
| M-002-01 | 「退会する」ボタンをクリックするとブラウザの確認ダイアログが表示されること | 🟢 |
| M-002-02 | 確認ダイアログに「退会すると全ての情報が削除されます。よろしいですか？」というメッセージが表示されること | 🟢 |
| M-002-03 | 確認ダイアログに「OK」と「キャンセル」のボタンが表示されること | 🟢 |

### M-003: 退会処理の実行（OKを選択した場合）

| No | 項目 | 信頼性 |
|----|------|--------|
| M-003-01 | 確認ダイアログでOKを選択するとセッションクッキーが削除されること | 🟢 |
| M-003-02 | 確認ダイアログでOKを選択するとLocalStorageからユーザーデータが削除されること | 🟢 |
| M-003-03 | 退会処理完了後に完了メッセージ「退会処理を完了しました。ご利用ありがとうございました。」が表示されること | 🟢 |
| M-003-04 | 完了メッセージ確認後にトップページ（index.html）へ遷移すること | 🟢 |
| M-003-05 | 退会後のトップページは未ログイン状態で表示されること | 🟢 |

### M-004: キャンセル時の動作

| No | 項目 | 信頼性 |
|----|------|--------|
| M-004-01 | 確認ダイアログでキャンセルを選択するとフォームの送信がキャンセルされること | 🟢 |
| M-004-02 | キャンセル選択後もマイページに留まること（ページ遷移が発生しないこと） | 🟢 |
| M-004-03 | キャンセル選択後もユーザーデータが削除されないこと | 🟢 |
| M-004-04 | キャンセル選択後もセッションクッキーが維持されること | 🟢 |

### M-005: アクセス制御

| No | 項目 | 信頼性 |
|----|------|--------|
| M-005-01 | 未ログイン状態でマイページにアクセスした場合、トップページへリダイレクトされること | 🟢 |

---

## Never（できてはいけない）

### N-001: プリセットユーザーによる退会の禁止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-001-01 | 事前登録テストユーザー（ichiro / sakura / jun / yoshiki）がログイン中に「退会する」ボタンが操作可能状態になってはいけない | 🟢 |
| N-001-02 | 事前登録テストユーザーが退会処理を実行できてはいけない | 🟢 |

### N-002: 確認なしの退会実行の禁止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-002-01 | 確認ダイアログなしに退会処理が実行されてはいけない | 🟢 |
| N-002-02 | キャンセルを選択した場合に退会処理が実行されてはいけない | 🟢 |

### N-003: 不正なデータ状態の禁止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-003-01 | 退会後もLocalStorageにユーザーデータが残存してはいけない | 🟢 |
| N-003-02 | 退会後もセッションクッキーが有効な状態で残存してはいけない | 🟢 |
| N-003-03 | 退会後に同じメールアドレスでログインできてはいけない | 🟢 |

### N-004: キャンセル後のデータ破損の禁止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-004-01 | キャンセル後にユーザーデータがLocalStorageから削除されてはいけない | 🟢 |
| N-004-02 | キャンセル後にセッションクッキーが無効化されてはいけない | 🟢 |

---

## 信号サマリー

| 信号 | 件数 | 内容 |
|------|------|------|
| 🟢 | 24 | 全項目（退会ボタン表示、確認ダイアログ、退会処理、キャンセル動作、アクセス制御、プリセットユーザー制限、確認なし禁止、データ残存禁止） |
| 🟡 | 0 | - |
| 🔴 | 0 | - |
