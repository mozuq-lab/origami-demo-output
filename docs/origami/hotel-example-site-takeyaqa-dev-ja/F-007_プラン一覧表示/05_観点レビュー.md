# 観点レビュー: F-007 プラン一覧表示

## 生成情報

- 生成日時: 2026-02-23
- 入力ソース: 04_テストケース.md, 01_機能詳細.md
- 参照カタログ: テスト観点カタログ v1.6（TIS株式会社, CC BY-SA 4.0）
- アプリ種別: web
- 対象機能: F-007 プラン一覧表示
- 総観点数: 22件（対象: 22件 / 対象外: 0件）
- 信号分布: 🟢 10件 / 🟡 9件 / 🔴 3件

---

## カバレッジサマリー

| セクション | 対象観点数 | 🟢 カバー済 | 🟡 未カバー推奨 | 🔴 要確認 | カバー率 |
|-----------|-----------|------------|----------------|----------|---------|
| バリデーション（VAL） | 3 | 3 | 0 | 0 | 100% |
| ウェブアプリケーション（WEB） | 8 | 3 | 4 | 1 | 38% |
| セキュリティ共通（SEC-C） | 4 | 2 | 1 | 1 | 50% |
| セキュリティウェブ（SEC-W） | 2 | 0 | 2 | 0 | 0% |
| ユーザビリティ（USA） | 5 | 2 | 2 | 1 | 40% |
| **合計** | **22** | **10** | **9** | **3** | **45%** |

> 注記: F-007は表示専用機能のため、フォーム入力系のVAL観点（文字数・文字種・必須チェック等）は対象外として除外済み。表示データの正確性・状態依存表示・境界値件数の3観点のみVAL対象とした。

---

## 🟢 カバー済み観点

| # | 観点ID | 観点名 | 対応テストケース | カテゴリ |
|---|--------|--------|----------------|---------|
| 1 | VP-VAL-011 | 正常データの表示正確性確認 | TC-007-11 | バリデーション |
| 2 | VP-VAL-014 | ユーザー状態による表示内容の変化 | TC-007-03, TC-007-04, TC-007-05, TC-007-06 | バリデーション |
| 3 | VP-VAL-015 | 境界値での表示件数確認 | TC-007-05, TC-007-07, TC-007-08, TC-007-15 | バリデーション |
| 4 | VP-WEB-001 | ページ遷移・ナビゲーション | TC-007-14, TC-007-03, TC-007-04 | ウェブアプリケーション |
| 5 | VP-WEB-002 | 新規タブ/ウィンドウ遷移 | TC-007-13 | ウェブアプリケーション |
| 6 | VP-WEB-008 | Ajax/非同期通信・ローディング表示 | TC-007-02 | ウェブアプリケーション |
| 7 | VP-SEC-C-001 | 認証・認可（ユーザー種別によるアクセス制御） | TC-007-05, TC-007-06, TC-007-07, TC-007-08, TC-007-09, TC-007-10 | セキュリティ共通 |
| 8 | VP-SEC-C-002 | セッション管理（ログイン状態の反映） | TC-007-03, TC-007-04, TC-007-15 | セキュリティ共通 |
| 9 | VP-USA-001 | ローディング・進行フィードバック | TC-007-02 | ユーザビリティ |
| 10 | VP-USA-003 | コンテンツ表示の正確性・視認性 | TC-007-11, TC-007-12 | ユーザビリティ |

---

## 🟡 未カバー推奨観点

| # | 観点ID | 観点名 | 推奨理由 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-WEB-003 | ページリロード時のデータ再取得 | Ajaxで非同期取得するページのため、リロード時に再度データが正しく取得・表示されるか確認が必要 | ウェブアプリケーション |
| 2 | VP-WEB-004 | ブラウザバック・履歴操作後の表示 | 予約ページ（新規タブ）を閉じた後、または別ページから戻ったときにプラン一覧が正しく表示されるか確認が必要 | ウェブアプリケーション |
| 3 | VP-WEB-005 | ページ表示後のログイン状態変化 | 別タブでログイン/ログアウトした後にplans.htmlをリロードした場合、表示プラン数が正しく変化するか未検証 | ウェブアプリケーション |
| 4 | VP-WEB-006 | Ajaxキャッシュ制御（Date.now()の有効性） | N-002-01で🟡となっているDate.now()によるキャッシュ回避の実動作が未検証。同一URLを連続して開いた際の旧データ表示が起こらないことの確認が必要 | ウェブアプリケーション |
| 5 | VP-SEC-C-003 | Ajax失敗時のエラーハンドリング | BV-004-03（データ取得失敗）が🟡として境界値分析に記載されているが、テストケース未生成。$.getJSONの.failハンドラが未実装の場合の挙動確認が必要 | セキュリティ共通 |
| 6 | VP-SEC-W-001 | XSS（プラン名・データのHTML挿入） | JavaScriptでHTMLを動的生成して#plan-listに挿入する実装のため、プラン名や説明にXSSペイロードが含まれた場合のエスケープ処理確認が必要 | セキュリティウェブ |
| 7 | VP-SEC-W-003 | クライアントサイドフィルタリングの迂回 | plan_data.jsonには全プラン（会員限定・プレミアム限定含む）が含まれており、未ログインユーザーでも直接JSONにアクセス可能。設計上の既知制約だが、テスト観点として記録が推奨 | セキュリティウェブ |
| 8 | VP-USA-002 | Ajax失敗時のユーザーへのエラー通知 | データ取得失敗時に「Loading...」が残るのか、エラーメッセージが表示されるのか未確認。ユーザーに状況を伝えるフィードバックの有無確認が推奨 | ユーザビリティ |
| 9 | VP-USA-005 | レスポンシブ対応の実表示確認 | 01_機能詳細.mdにBootstrapグリッド（col-12/col-md-6/col-lg-4）使用が明記されているが、各ブレークポイントでの実際のカードレイアウト確認が未実施 | ユーザビリティ |

---

## 🔴 要確認観点

| # | 観点ID | 観点名 | 確認内容 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-WEB-009 | ブラウザ互換性 | 仕様書にテスト対象ブラウザの記載がない。jQueryとBootstrap使用のため主要ブラウザ（Chrome/Firefox/Safari/Edge）での動作対象範囲をステークホルダーに確認が必要 | ウェブアプリケーション |
| 2 | VP-SEC-C-004 | クライアントサイドのロジック保護 | プラン表示制御ロジックがplan_data.json＋JavaScriptで実装されており、ブラウザの開発者ツールでJavaScriptを操作することで会員限定プランを強制表示できる可能性がある。これが許容設計かどうかステークホルダー確認が必要 | セキュリティ共通 |
| 3 | VP-USA-004 | アクセシビリティ（WCAG準拠） | プランカードのaria-label、バッジのスクリーンリーダー対応、予約ボタンのフォーカス管理等が仕様書に記載なし。アクセシビリティ要件の有無をステークホルダーに確認が必要 | ユーザビリティ |

---

## 補完テストケース案

🟡項目に対する補完テストケース案を以下に示します。

---

### STC-007-01: リロード時にプラン一覧が再取得・表示されること

| 項目 | 内容 |
|------|------|
| テストID | STC-007-01 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-WEB-003 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- プラン一覧ページが表示されており、プランカードが表示されている

**When（実行条件）:**

1. ブラウザのリロードボタンを押してページを再読み込みする

**Then（期待結果）:**

- [ ] 「Loading...」が再度表示された後、プランカードが表示されること
- [ ] リロード前と同じプラン数・内容が表示されること

**根拠:** テスト観点カタログ VP-WEB-003（ページリロード時のデータ再取得）に基づく補完

---

### STC-007-02: ブラウザバック後にプラン一覧が正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | STC-007-02 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-WEB-004 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- プラン一覧ページを表示した後、「ホーム」リンクでトップページに遷移している

**When（実行条件）:**

1. ブラウザの戻るボタンをクリックしてplans.htmlに戻る

**Then（期待結果）:**

- [ ] プラン一覧ページが正しく表示されること
- [ ] ユーザーの現在のログイン状態に応じたプランが表示されること

**根拠:** テスト観点カタログ VP-WEB-004（ブラウザバック後の表示）に基づく補完

---

### STC-007-03: 別タブでログアウト後にリロードすると未ログイン状態の表示になること

| 項目 | 内容 |
|------|------|
| テストID | STC-007-03 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-WEB-005 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 一般会員（sakura）でログイン済みでプラン一覧ページ（8件表示）を開いている
- 別タブでログアウト処理を行い、Cookieのsessionが削除されている

**When（実行条件）:**

1. プラン一覧ページをリロードする

**Then（期待結果）:**

- [ ] 6件のプランが表示されること（未ログイン状態）
- [ ] ナビゲーションが未ログイン状態（「会員登録」「ログイン」表示）に切り替わること

**根拠:** テスト観点カタログ VP-WEB-005（ページ表示後のログイン状態変化）に基づく補完

---

### STC-007-04: 同一URLを連続して開いた際にキャッシュが使用されないこと

| 項目 | 内容 |
|------|------|
| テストID | STC-007-04 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-WEB-006 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- プラン一覧ページを1回表示してプランカードが表示されている

**When（実行条件）:**

1. ブラウザの開発者ツールでネットワークタブを開く
2. plans.htmlをリロードする
3. plan_data.jsonへのリクエストURLを確認する

**Then（期待結果）:**

- [ ] plan_data.jsonのリクエストURLにタイムスタンプクエリパラメータ（`?{数値}`）が付与されていること
- [ ] 2回目以降も毎回異なるタイムスタンプが付与されること（キャッシュ回避）
- [ ] ネットワークステータスが304（キャッシュ）ではなく200であること

**根拠:** テスト観点カタログ VP-WEB-006（キャッシュ制御）に基づく補完

---

### STC-007-05: plan_data.json取得失敗時の挙動確認

| 項目 | 内容 |
|------|------|
| テストID | STC-007-05 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-SEC-C-003 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- ブラウザの開発者ツールでネットワークを制限（オフライン）またはplan_data.jsonへのリクエストをブロックする設定にしている

**When（実行条件）:**

1. plans.htmlを表示する

**Then（期待結果）:**

- [ ] 「Loading...」が長時間表示されるか、エラーメッセージが表示されること
- [ ] ページがクラッシュしないこと（JavaScriptエラーが握り潰されるか適切に処理されること）
- [ ] ユーザーに状況を伝えるフィードバックがあることが望ましい（🟡）

**根拠:** テスト観点カタログ VP-SEC-C-003（エラーハンドリング）に基づく補完

---

### STC-007-06: プラン名にHTMLタグが含まれる場合のエスケープ確認

| 項目 | 内容 |
|------|------|
| テストID | STC-007-06 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-SEC-W-001 |
| テスト種別 | 異常系（セキュリティ） |
| 信号 | 🟡 |

**Given（前提条件）:**

- plan_data.jsonのプラン名に `<script>alert('XSS')</script>` を含むデータが存在する（テスト環境のみ）

**When（実行条件）:**

1. plans.htmlを表示する

**Then（期待結果）:**

- [ ] スクリプトが実行されないこと
- [ ] プラン名がテキストとして表示されること（HTMLタグがエスケープされること）

**根拠:** テスト観点カタログ VP-SEC-W-001（XSS対策）に基づく補完

---

### STC-007-07: 未ログインユーザーがplan_data.jsonに直接アクセスした場合の挙動確認

| 項目 | 内容 |
|------|------|
| テストID | STC-007-07 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-SEC-W-003 |
| テスト種別 | 異常系（セキュリティ・設計確認） |
| 信号 | 🟡 |

**Given（前提条件）:**

- 未ログイン状態である

**When（実行条件）:**

1. ブラウザのアドレスバーに直接 `{origin}/data/ja/plan_data.json` を入力してアクセスする

**Then（期待結果）:**

- [ ] JSONデータが取得できることを確認する（現状の設計動作として記録）
- [ ] 取得したデータに会員限定プラン（id=2,3）・プレミアム限定プラン（id=1）・id=0のデータが含まれることを確認する
- 【設計確認】この挙動がテスト自動化練習サイトとして意図的なものであることをステークホルダーに確認する

**根拠:** テスト観点カタログ VP-SEC-W-003（クライアントサイドアクセス制御の迂回）に基づく補完

---

### STC-007-08: Ajax取得失敗時にユーザーへエラーメッセージが表示されること

| 項目 | 内容 |
|------|------|
| テストID | STC-007-08 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-USA-002 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- plan_data.jsonへのアクセスが失敗する環境（オフライン/ブロック）

**When（実行条件）:**

1. plans.htmlを表示する
2. データ読み込み完了まで待機する

**Then（期待結果）:**

- [ ] ユーザーに対してデータ取得失敗を伝えるメッセージが表示されること（望ましい動作）
- [ ] または「Loading...」が表示されたまま固まらないこと
- 【確認】現状の実装で.failハンドラが存在するか確認する

**根拠:** テスト観点カタログ VP-USA-002（エラー時のユーザー通知）に基づく補完

---

### STC-007-09: レスポンシブ表示でプランカードのレイアウトが正しく変化すること

| 項目 | 内容 |
|------|------|
| テストID | STC-007-09 |
| 対象機能 | F-007: プラン一覧表示 |
| 対応観点 | VP-USA-005 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- プラン一覧ページを表示している（未ログイン、6件表示）

**When（実行条件）:**

1. ブラウザ幅を1200px以上（PC）に設定する
2. ブラウザ幅を768px〜1199px（タブレット）に設定する
3. ブラウザ幅を767px以下（モバイル）に設定する

**Then（期待結果）:**

- [ ] PC幅（col-lg-4）: プランカードが3列で表示されること
- [ ] タブレット幅（col-md-6）: プランカードが2列で表示されること
- [ ] モバイル幅（col-12）: プランカードが1列で表示されること
- [ ] いずれの幅でもプランカードの内容が切れずに表示されること

**根拠:** テスト観点カタログ VP-USA-005（レスポンシブ対応）に基づく補完

---

## 優先対応一覧

| # | 観点ID | 観点名 | 対応方針 | 信号 |
|---|--------|--------|---------|------|
| 1 | VP-SEC-C-003 | Ajax失敗時エラーハンドリング | 補完テストケース案あり（STC-007-05） | 🟡 |
| 2 | VP-WEB-005 | ログアウト後リロードでの表示変化 | 補完テストケース案あり（STC-007-03） | 🟡 |
| 3 | VP-SEC-W-001 | XSS（プラン名HTMLエスケープ） | 補完テストケース案あり（STC-007-06）。テスト環境限定 | 🟡 |
| 4 | VP-SEC-W-003 | JSONへの直接アクセス（全プランデータ取得） | 補完テストケース案あり（STC-007-07）。設計上の既知制約として確認推奨 | 🟡 |
| 5 | VP-WEB-006 | Ajaxキャッシュ制御（Date.now()） | 補完テストケース案あり（STC-007-04） | 🟡 |
| 6 | VP-WEB-003 | リロード時のデータ再取得 | 補完テストケース案あり（STC-007-01） | 🟡 |
| 7 | VP-WEB-004 | ブラウザバック後の表示 | 補完テストケース案あり（STC-007-02） | 🟡 |
| 8 | VP-USA-002 | Ajax失敗時ユーザー通知 | 補完テストケース案あり（STC-007-08） | 🟡 |
| 9 | VP-USA-005 | レスポンシブ対応 | 補完テストケース案あり（STC-007-09） | 🟡 |
| 10 | VP-SEC-C-004 | クライアントサイドロジック保護 | ステークホルダー確認必須（設計上の判断が必要） | 🔴 |
| 11 | VP-WEB-009 | ブラウザ互換性 | テスト対象ブラウザの定義をステークホルダーに確認 | 🔴 |
| 12 | VP-USA-004 | アクセシビリティ（WCAG） | アクセシビリティ要件の有無をステークホルダーに確認 | 🔴 |

---

## 参照カタログ情報

- **原典**: テスト観点カタログ v1.6
- **著作者**: TIS株式会社
- **ライセンス**: CC BY-SA 4.0 (Creative Commons Attribution-ShareAlike 4.0 International)
- **抽出範囲**: ブラックボックステスト関連項目（5セクション）
- **適用セクション**: VAL（バリデーション）, WEB（ウェブアプリケーション）, SEC-C（セキュリティ共通）, SEC-W（セキュリティウェブ）, USA（ユーザビリティ）

---

## 次のステップ

### 補完テストケースの反映

🟡項目の補完テストケース案を既存のテストケースに反映するには:

1. **手動追記**: `04_テストケース.md` に補完テストケース案をコピーして追記
2. **優先度付け**: STC-007-03（ログアウト後リロード）、STC-007-05（Ajax失敗）を優先対応推奨
3. **STC-007-07は設計確認**: クライアントサイドフィルタリングはテスト自動化練習サイトの設計意図として許容されている可能性が高い

### 確認事項

- 🔴項目（VP-SEC-C-004、VP-WEB-009、VP-USA-004）についてステークホルダーに確認
- カバー率45%（推奨70%以上）について、表示専用機能という性質を踏まえてチームと協議
- STC-007-06（XSSテスト）は本番データに影響しないテスト環境での実施を推奨
