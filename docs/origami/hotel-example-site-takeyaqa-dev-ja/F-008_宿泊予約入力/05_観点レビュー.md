# 観点レビュー: F-008 宿泊予約入力

## 生成情報

- 生成日時: 2026-02-23
- 入力ソース: 04_テストケース.md, 01_機能詳細.md
- 参照カタログ: テスト観点カタログ v1.6（TIS株式会社, CC BY-SA 4.0）
- アプリ種別: web
- 対象機能: F-008 宿泊予約入力
- 総観点数: 31件（対象: 31件 / 対象外: 0件）
- 信号分布: 🟢 19件 / 🟡 10件 / 🔴 2件

---

## カバレッジサマリー

| セクション | 対象観点数 | 🟢 カバー済 | 🟡 未カバー推奨 | 🔴 要確認 | カバー率 |
|-----------|-----------|------------|----------------|----------|---------|
| バリデーション（VAL） | 12 | 10 | 2 | 0 | 83% |
| ウェブアプリケーション（WEB） | 7 | 4 | 3 | 0 | 57% |
| セキュリティ共通（SEC-C） | 4 | 2 | 2 | 0 | 50% |
| セキュリティウェブ（SEC-W） | 3 | 0 | 2 | 1 | 0% |
| ユーザビリティ（USA） | 5 | 3 | 1 | 1 | 60% |
| **合計** | **31** | **19** | **10** | **2** | **61%** |

---

## 🟢 カバー済み観点

| # | 観点ID | 観点名 | 対応テストケース | カテゴリ |
|---|--------|--------|----------------|---------|
| 1 | VP-VAL-001 | 必須入力チェック | TC-008-26（氏名）, TC-008-27（連絡方法）, TC-008-19（メール）, TC-008-10（電話） | バリデーション |
| 2 | VP-VAL-002 | 文字数制限（上限） | TC-008-28（140文字有効）, TC-008-29（141文字切り捨て） | バリデーション |
| 3 | VP-VAL-003 | 文字種・形式チェック | TC-008-25（電話ハイフン）, TC-008-20（メール形式） | バリデーション |
| 4 | VP-VAL-004 | 数値入力の範囲チェック（上限・下限） | TC-008-07〜11（宿泊数・人数のmin/max） | バリデーション |
| 5 | VP-VAL-005 | 日付の有効範囲チェック | TC-008-04（翌日有効）, TC-008-05（90日後有効）, TC-008-06（91日後無効） | バリデーション |
| 6 | VP-VAL-006 | 条件付き必須チェック（連動フィールド） | TC-008-18/19（contact=email時のメール必須）, TC-008-21（contact=tel時の電話必須） | バリデーション |
| 7 | VP-VAL-007 | 選択肢バリデーション（必須select） | TC-008-27（連絡方法「選択してください」のまま送信不可） | バリデーション |
| 8 | VP-VAL-008 | 桁数チェック | TC-008-22（11桁有効）, TC-008-23（10桁無効）, TC-008-24（12桁無効） | バリデーション |
| 9 | VP-VAL-009 | プラン固有の制約（動的min/max） | TC-008-12（カップル限定min=max=2）, TC-008-13（貸し切り露天maxTerm=3） | バリデーション |
| 10 | VP-VAL-010 | 任意フィールドの省略可能確認 | TC-008-30（ご要望省略で送信可） | バリデーション |
| 11 | VP-WEB-001 | ページ遷移・フォーム送信後の遷移 | TC-008-32（confirm.htmlへ遷移） | ウェブアプリケーション |
| 12 | VP-WEB-002 | 動的フィールドの有効化/無効化 | TC-008-18（メールenabled）, TC-008-21（電話enabled）, TC-008-17（両方disabled） | ウェブアプリケーション |
| 13 | VP-WEB-003 | 動的計算・リアルタイム更新 | TC-008-14/15/16（合計金額の自動再計算） | ウェブアプリケーション |
| 14 | VP-WEB-004 | 日付ピッカー（カレンダーUI）の操作 | TC-008-04/05/06（jQuery UI Datepickerによる日付選択） | ウェブアプリケーション |
| 15 | VP-SEC-C-001 | バリデーションエラー時の送信防止 | TC-008-09（宿泊数超過）, TC-008-11（人数超過）, TC-008-23/24（電話不正） | セキュリティ共通 |
| 16 | VP-SEC-C-002 | フォームデータの保存・引き継ぎ | TC-008-32（sessionStorageへの保存後confirm.htmlへ遷移） | セキュリティ共通 |
| 17 | VP-USA-001 | バリデーションエラーメッセージの表示 | TC-008-06（日付エラー）, TC-008-09（範囲エラー）, TC-008-23（桁数エラー） | ユーザビリティ |
| 18 | VP-USA-002 | リアルタイムフィードバック（合計金額表示） | TC-008-14/15/16（金額のリアルタイム更新） | ユーザビリティ |
| 19 | VP-USA-003 | 送信ボタンの有効化フロー（操作ガイド） | TC-008-02（初期disabled）, TC-008-31（全入力完了でenabled） | ユーザビリティ |

---

## 🟡 未カバー推奨観点

| # | 観点ID | 観点名 | 推奨理由 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-VAL-011 | 空白文字のみの必須入力（スペースバイパス） | 氏名フィールドにスペースのみを入力した場合、HTML5のrequiredはスペースを有効とみなす場合があり、空の予約が作成される可能性がある | バリデーション |
| 2 | VP-VAL-012 | 入力値の上限件数を1つ下回る値の確認 | ご要望139文字（140の境界値-1）が正常に入力できることを確認が推奨される | バリデーション |
| 3 | VP-WEB-005 | ブラウザバック後のフォーム状態 | confirm.htmlからブラウザバックした場合に、reserve.htmlのフォームデータが復元されるか（autofill等で再入力が必要か）の確認が必要 | ウェブアプリケーション |
| 4 | VP-WEB-006 | 重複送信防止 | 「予約内容を確認する」ボタンを高速で複数回クリックした場合に、confirm.htmlへの遷移が1回のみ実行されることの確認が必要 | ウェブアプリケーション |
| 5 | VP-WEB-007 | レスポンシブ対応・モバイル表示 | Bootstrapを使用しているが、モバイル幅でのフォームレイアウト（カレンダー、入力フィールド）の表示確認が未実施 | ウェブアプリケーション |
| 6 | VP-SEC-C-003 | sessionStorageに保存されたデータの完全性確認 | sessionStorageに正しいデータ（プランID・名前・料金・入力値・合計）が保存されているかの確認が必要。confirm.htmlで正しく表示されることで間接的に確認可能 | セキュリティ共通 |
| 7 | VP-SEC-C-004 | 不正なplan-idパラメータの処理 | ?plan-id=999など存在しないIDをURLに指定した場合、フォームがどのように振る舞うかの確認が推奨される | セキュリティ共通 |
| 8 | VP-SEC-W-001 | XSS（氏名・ご要望フィールドへのスクリプト注入） | 氏名やご要望に `<script>alert('XSS')</script>` を入力した場合、confirm.htmlでエスケープされて表示されるかの確認が必要（入力はできるが表示時のエスケープが重要） | セキュリティウェブ |
| 9 | VP-SEC-W-003 | plan-idパラメータの改ざん | URLの?plan-id=1（プレミアムプラン）を直接入力した場合、一般会員でも予約フォームが開けるかの確認（設計上の意図確認） | セキュリティウェブ |
| 10 | VP-USA-005 | ヒントテキストの表示（電話番号入力例） | TC-008-22で電話番号の有効確認はしているが、「11桁の数字で入力してください。例：01133335555」のヒントテキストが表示されることの明示的な確認ケースが未作成 | ユーザビリティ |

---

## 🔴 要確認観点

| # | 観点ID | 観点名 | 確認内容 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-SEC-W-002 | CSRF対策 | フォーム送信にCSRFトークンが実装されているかの確認が必要。テスト自動化練習サイトとしてCSRFは対象外の可能性があるが、ステークホルダーへの確認が必要 | セキュリティウェブ |
| 2 | VP-USA-004 | アクセシビリティ（WCAG準拠） | フォームのaria-label、エラーメッセージのaria-live、Datepickerのキーボード操作対応等のアクセシビリティ要件が仕様書に記載なし。要件の有無をステークホルダーに確認が必要 | ユーザビリティ |

---

## 補完テストケース案

🟡項目に対する補完テストケース案を以下に示します。

---

### STC-008-01: 氏名フィールドに空白文字のみを入力した場合の挙動確認

| 項目 | 内容 |
|------|------|
| テストID | STC-008-01 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-VAL-011 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いており、宿泊日・宿泊数・人数・連絡方法が有効な状態

**When（実行条件）:**

1. 氏名フィールドに半角スペースのみ（「 」1文字）を入力する
2. 「予約内容を確認する」ボタンをクリックする

**Then（期待結果）:**

- [ ] フォームが送信されないこと（空白のみは無効として扱われること）
- [ ] または confirm.html で氏名が空白になるため設計確認が必要

**根拠:** テスト観点カタログ VP-VAL-011（空白文字バイパス）に基づく補完

---

### STC-008-02: ご要望139文字（境界値-1）が入力できること

| 項目 | 内容 |
|------|------|
| テストID | STC-008-02 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-VAL-012 |
| テスト種別 | 正常系（境界値） |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いている

**When（実行条件）:**

1. ご要望フィールドに139文字のテキストを入力する

**Then（期待結果）:**

- [ ] 139文字が正常に入力されること（切り捨てが発生しないこと）

**根拠:** テスト観点カタログ VP-VAL-012（境界値-1の確認）に基づく補完

---

### STC-008-03: confirm.htmlからブラウザバックした場合のフォーム状態確認

| 項目 | 内容 |
|------|------|
| テストID | STC-008-03 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-WEB-005 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html で必要事項を入力して confirm.html へ遷移している

**When（実行条件）:**

1. ブラウザの戻るボタンをクリックして reserve.html に戻る

**Then（期待結果）:**

- [ ] reserve.html が表示されること
- [ ] 入力内容がブラウザのautofillで復元されるか、または空白に戻るかを確認すること

**根拠:** テスト観点カタログ VP-WEB-005（ブラウザバック後のフォーム状態）に基づく補完

---

### STC-008-04: 送信ボタンを連続クリックしても重複遷移しないこと

| 項目 | 内容 |
|------|------|
| テストID | STC-008-04 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-WEB-006 |
| テスト種別 | 異常系（操作誤り） |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いており、全必須項目が有効な状態（送信ボタンenabled）

**When（実行条件）:**

1. 「予約内容を確認する」ボタンを素早く2回連続クリックする

**Then（期待結果）:**

- [ ] confirm.htmlへの遷移が1回のみ実行されること
- [ ] 重複した予約データがsessionStorageに書き込まれないこと

**根拠:** テスト観点カタログ VP-WEB-006（重複送信防止）に基づく補完

---

### STC-008-05: モバイル幅でフォームが正しくレイアウトされること

| 項目 | 内容 |
|------|------|
| テストID | STC-008-05 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-WEB-007 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いている

**When（実行条件）:**

1. ブラウザ幅を767px以下（モバイル幅）に設定する
2. フォーム全体を確認する

**Then（期待結果）:**

- [ ] すべてのフォームフィールドが縦1列で表示されること
- [ ] フィールドや文字が画面幅に収まっていること（横スクロールが発生しないこと）
- [ ] カレンダーUIが画面内に表示されること

**根拠:** テスト観点カタログ VP-WEB-007（レスポンシブ対応）に基づく補完

---

### STC-008-06: sessionStorageに正しい予約データが保存されること

| 項目 | 内容 |
|------|------|
| テストID | STC-008-06 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-SEC-C-003 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いており、以下の値を入力済み:
  - 宿泊日: 翌日、宿泊数: 2泊、人数: 2人、朝食バイキング選択
  - 氏名: 山田太郎、連絡方法: 希望しない

**When（実行条件）:**

1. 「予約内容を確認する」ボタンをクリックする
2. confirm.htmlへ遷移後、ブラウザ開発者ツールでsessionStorageの内容を確認する

**Then（期待結果）:**

- [ ] sessionStorage（キー: `reservation-data`）に以下のデータが保存されていること:
  - プランID、プラン名、宿泊日、宿泊数、人数、オプション、氏名、連絡方法、合計金額
- [ ] 合計金額が正しい値（5,500×2×2 + 1,000×2×2 = 26,000円）であること

**根拠:** テスト観点カタログ VP-SEC-C-003（セッションデータの完全性）に基づく補完

---

### STC-008-07: 存在しないplan-idを指定した場合の挙動確認

| 項目 | 内容 |
|------|------|
| テストID | STC-008-07 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-SEC-C-004 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- ブラウザで直接URLにアクセスする

**When（実行条件）:**

1. `reserve.html?plan-id=999`（存在しないID）にアクセスする

**Then（期待結果）:**

- [ ] エラーページが表示されるか、フォームが空の状態で表示されること
- [ ] JavaScriptエラーがコンソールに出力される場合は記録する

**根拠:** テスト観点カタログ VP-SEC-C-004（不正パラメータの処理）に基づく補完

---

### STC-008-08: 氏名・ご要望へのXSSペイロード入力がエスケープされること

| 項目 | 内容 |
|------|------|
| テストID | STC-008-08 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-SEC-W-001 |
| テスト種別 | 異常系（セキュリティ） |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いており、宿泊日・宿泊数・人数・連絡方法が有効な状態

**When（実行条件）:**

1. 氏名フィールドに `<script>alert('XSS')</script>` を入力する
2. 「予約内容を確認する」ボタンをクリックする

**Then（期待結果）:**

- [ ] confirm.htmlに遷移した場合、スクリプトが実行されないこと
- [ ] 氏名がテキストとしてエスケープされて表示されること

**根拠:** テスト観点カタログ VP-SEC-W-001（XSS対策）に基づく補完

---

### STC-008-09: 不正なplan-idでも予約フォームが開けるか確認

| 項目 | 内容 |
|------|------|
| テストID | STC-008-09 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-SEC-W-003 |
| テスト種別 | 異常系（設計確認） |
| 信号 | 🟡 |

**Given（前提条件）:**

- 一般会員（sakura）としてログイン済み

**When（実行条件）:**

1. ブラウザのアドレスバーに直接 `reserve.html?plan-id=1`（プレミアムプラン）を入力してアクセスする

**Then（期待結果）:**

- [ ] プレミアムプランの予約フォームが開けるか、またはアクセス制御が働くかを確認する
- 【設計確認】テスト自動化練習サイトとして、この挙動が意図的なものかどうかステークホルダーへ確認推奨

**根拠:** テスト観点カタログ VP-SEC-W-003（パラメータ改ざん）に基づく補完

---

### STC-008-10: 電話番号入力欄のヒントテキスト表示確認

| 項目 | 内容 |
|------|------|
| テストID | STC-008-10 |
| 対象機能 | F-008: 宿泊予約入力 |
| 対応観点 | VP-USA-005 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- reserve.html?plan-id=4 を開いている

**When（実行条件）:**

1. 連絡方法で「電話でのご連絡」を選択する
2. 電話番号フィールド周辺のヒントテキストを確認する

**Then（期待結果）:**

- [ ] 「11桁の数字で入力してください。例：01133335555」というヒントテキストが表示されること

**根拠:** テスト観点カタログ VP-USA-005（入力補助・ヒント表示）に基づく補完

---

## 優先対応一覧

| # | 観点ID | 観点名 | 対応方針 | 信号 |
|---|--------|--------|---------|------|
| 1 | VP-VAL-011 | 空白文字のみの氏名入力 | 補完テストケース案あり（STC-008-01）。セキュリティリスクあり | 🟡 |
| 2 | VP-SEC-W-001 | XSS（氏名・ご要望） | 補完テストケース案あり（STC-008-08）。confirm.htmlでの表示確認を含む | 🟡 |
| 3 | VP-SEC-C-003 | sessionStorageデータ完全性 | 補完テストケース案あり（STC-008-06）。F-009の前提確認として重要 | 🟡 |
| 4 | VP-SEC-C-004 | 不正plan-id処理 | 補完テストケース案あり（STC-008-07）。エラーハンドリング確認 | 🟡 |
| 5 | VP-WEB-006 | 重複送信防止 | 補完テストケース案あり（STC-008-04）。UX改善として重要 | 🟡 |
| 6 | VP-WEB-005 | ブラウザバック後のフォーム状態 | 補完テストケース案あり（STC-008-03） | 🟡 |
| 7 | VP-SEC-W-003 | plan-idパラメータ改ざん | 補完テストケース案あり（STC-008-09）。設計意図の確認が必要 | 🟡 |
| 8 | VP-VAL-012 | ご要望139文字（境界値-1） | 補完テストケース案あり（STC-008-02）。境界値テストの網羅性向上 | 🟡 |
| 9 | VP-WEB-007 | レスポンシブ対応 | 補完テストケース案あり（STC-008-05） | 🟡 |
| 10 | VP-USA-005 | ヒントテキスト表示 | 補完テストケース案あり（STC-008-10） | 🟡 |
| 11 | VP-SEC-W-002 | CSRF対策 | ステークホルダー確認必須（練習サイトとして意図的に未実装の可能性） | 🔴 |
| 12 | VP-USA-004 | アクセシビリティ（WCAG） | ステークホルダー確認必須（要件の有無を確認） | 🔴 |

---

## 参照カタログ情報

- **原典**: テスト観点カタログ v1.6
- **著作者**: TIS株式会社
- **ライセンス**: CC BY-SA 4.0 (Creative Commons Attribution-ShareAlike 4.0 International)
- **抽出範囲**: ブラックボックステスト関連項目（5セクション）
- **適用セクション**: VAL（バリデーション）, WEB（ウェブアプリケーション）, SEC-C（セキュリティ共通）, SEC-W（セキュリティウェブ）, USA（ユーザビリティ）

---

## 次のステップ

### 補完テストケースの反映

🟡項目の補完テストケース案を既存のテストケースに反映するには:

1. **手動追記**: `04_テストケース.md` に補完テストケース案をコピーして追記
2. **優先対応**: STC-008-01（空白氏名）、STC-008-08（XSS）、STC-008-06（sessionStorage確認）を優先推奨
3. **F-009との連携**: STC-008-06は confirm.html（F-009）でのデータ表示確認と組み合わせて実施推奨

### 確認事項

- 🔴項目（VP-SEC-W-002 CSRF、VP-USA-004 アクセシビリティ）についてステークホルダーに確認
- カバー率61%（推奨70%以上に向けて）: VAL=83%（良好）、WEB=57%、SEC-C=50%（要改善）
- F-009（予約確認）のテスト実施前に、STC-008-06のsessionStorageデータ確認を行うことを推奨
