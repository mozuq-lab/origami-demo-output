# F-008 宿泊予約入力 動作仕様

## 基本情報

| 項目 | 内容 |
|------|------|
| 機能ID | F-008 |
| 機能名 | 宿泊予約入力 |
| 入力ファイル | 01_機能詳細.md |

---

## Must（できなければならない）

### M-001: ページ表示

| No | 項目 | 信頼性 |
|----|------|--------|
| M-001-01 | ページタイトルが「宿泊予約 \| HOTEL PLANISPHERE - テスト自動化練習サイト」であること | 🟢 |
| M-001-02 | URLパラメータ plan-id に対応するプランの情報がフォームに反映されること | 🟢 |
| M-001-03 | ページ読み込み時に合計金額が「-」で表示されること | 🟢 |
| M-001-04 | 送信ボタンが初期状態でdisabledであること | 🟢 |

### M-002: 宿泊日入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-002-01 | 宿泊日フィールドの初期値が本日の翌日であること | 🟢 |
| M-002-02 | jQuery UI Datepickerのカレンダーから日付を選択できること | 🟢 |
| M-002-03 | 本日から3ヶ月以内の日付のみ選択可能であること | 🟢 |
| M-002-04 | ヒントテキスト「ご予約は3ヶ月以内の日付のみ可能です。」が表示されること | 🟢 |
| M-002-05 | 宿泊日入力後に合計金額が計算・表示されること | 🟢 |

### M-003: 宿泊数・人数入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-003-01 | 宿泊数の初期値が1であること | 🟢 |
| M-003-02 | 人数の初期値が1であること | 🟢 |
| M-003-03 | 宿泊数の入力可能範囲がプランのminTerm〜maxTermに設定されること | 🟢 |
| M-003-04 | 人数の入力可能範囲がプランのminHeadCount〜maxHeadCountに設定されること | 🟢 |
| M-003-05 | 宿泊数・人数変更時に合計金額が自動再計算されること | 🟢 |

### M-004: オプション選択

| No | 項目 | 信頼性 |
|----|------|--------|
| M-004-01 | 朝食バイキング・昼からチェックインプラン・お得な観光プランの3つのオプションが表示されること | 🟢 |
| M-004-02 | オプションの単価として「お一人様各1,000円」が表示されること | 🟢 |
| M-004-03 | オプション選択時に合計金額が再計算されること（1,000円 × 人数 × 宿泊数 を加算） | 🟢 |
| M-004-04 | オプションを複数選択できること | 🟢 |
| M-004-05 | オプションを0個（すべて未選択）でも予約できること | 🟢 |

### M-005: 合計金額計算

| No | 項目 | 信頼性 |
|----|------|--------|
| M-005-01 | 合計金額が「基本宿泊料金 × 宿泊数 × 人数」で計算されること | 🟢 |
| M-005-02 | 選択したオプションの料金（1,000円 × 宿泊数 × 人数 × 選択オプション数）が合計に加算されること | 🟢 |
| M-005-03 | 宿泊日未入力時は合計金額が「-」であること | 🟢 |
| M-005-04 | 計算結果が `<output role="status">` 要素に表示されること | 🟢 |

### M-006: 氏名入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-006-01 | 氏名フィールドが必須であること | 🟢 |
| M-006-02 | 氏名フィールドは任意のテキストを入力できること（文字種制限なし） | 🟢 |

### M-007: 連絡方法選択

| No | 項目 | 信頼性 |
|----|------|--------|
| M-007-01 | 連絡方法の初期値が「選択してください」であること | 🟢 |
| M-007-02 | 連絡方法として「希望しない」「メールでのご連絡」「電話でのご連絡」の3つから選択できること | 🟢 |
| M-007-03 | 「メールでのご連絡」選択時にメールアドレスフィールドが有効化（enabled）されること | 🟢 |
| M-007-04 | 「電話でのご連絡」選択時に電話番号フィールドが有効化（enabled）されること | 🟢 |
| M-007-05 | 「希望しない」選択時はメールアドレス・電話番号フィールドが無効（disabled）であること | 🟢 |

### M-008: メールアドレス入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-008-01 | メールアドレスフィールドの初期状態がdisabledであること | 🟢 |
| M-008-02 | 「メールでのご連絡」選択時のみメールアドレスが必須となること | 🟢 |
| M-008-03 | type="email"によるブラウザネイティブ形式バリデーションが機能すること | 🟢 |

### M-009: 電話番号入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-009-01 | 電話番号フィールドの初期状態がdisabledであること | 🟢 |
| M-009-02 | 「電話でのご連絡」選択時のみ電話番号が必須となること | 🟢 |
| M-009-03 | 電話番号はpattern="[0-9]{11}"により半角数字11桁のみ有効であること | 🟢 |
| M-009-04 | ヒントテキスト「11桁の数字で入力してください。例：01133335555」が表示されること | 🟢 |

### M-010: ご要望・ご連絡事項入力

| No | 項目 | 信頼性 |
|----|------|--------|
| M-010-01 | ご要望フィールドは任意入力であること（必須でない） | 🟢 |
| M-010-02 | 入力文字数が最大140文字に制限されること（maxlength="140"） | 🟢 |

### M-011: 送信ボタン制御

| No | 項目 | 信頼性 |
|----|------|--------|
| M-011-01 | 全必須フィールドがバリデーションを通過した状態で送信ボタンがenableになること | 🟢 |
| M-011-02 | 未入力の必須フィールドがある場合に送信ボタンがdisabledのままであること | 🟢 |

### M-012: フォーム送信・遷移

| No | 項目 | 信頼性 |
|----|------|--------|
| M-012-01 | 「予約内容を確認する」ボタンクリック後にバリデーションが実行されること | 🟢 |
| M-012-02 | バリデーション通過時にトランザクションIDが生成されること | 🟢 |
| M-012-03 | 予約データがsessionStorageに保存されること | 🟢 |
| M-012-04 | confirm.htmlへ同一タブで遷移すること | 🟢 |

---

## Never（できてはいけない）

### N-001: 入力制限外のデータ送信防止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-001-01 | 宿泊日として3ヶ月より先の日付を入力して送信できてはいけない | 🟢 |
| N-001-02 | 宿泊日として過去の日付を入力して送信できてはいけない | 🟡 |
| N-001-03 | 宿泊数としてプランのmaxTermを超える値を入力して送信できてはいけない | 🟢 |
| N-001-04 | 宿泊数としてプランのminTerm未満の値を入力して送信できてはいけない | 🟢 |
| N-001-05 | 人数としてプランのmaxHeadCountを超える値を入力して送信できてはいけない | 🟢 |
| N-001-06 | 人数としてプランのminHeadCount未満の値を入力して送信できてはいけない | 🟢 |
| N-001-07 | 氏名未入力で送信できてはいけない | 🟢 |
| N-001-08 | 連絡方法を「選択してください」のまま送信できてはいけない | 🟢 |
| N-001-09 | 「メールでのご連絡」選択時にメールアドレス未入力で送信できてはいけない | 🟢 |
| N-001-10 | 「電話でのご連絡」選択時に電話番号未入力で送信できてはいけない | 🟢 |
| N-001-11 | 電話番号として11桁以外の数字を入力して送信できてはいけない | 🟢 |
| N-001-12 | 電話番号として数字以外の文字を含む文字列を入力して送信できてはいけない | 🟢 |
| N-001-13 | ご要望に140文字を超えるテキストを入力できてはいけない | 🟢 |
| N-001-14 | 必須フィールドが未完成の状態で送信ボタンが有効化されてはいけない | 🟢 |

### N-002: 連絡先フィールドの誤有効化防止

| No | 項目 | 信頼性 |
|----|------|--------|
| N-002-01 | 「希望しない」選択時にメールアドレスフィールドが入力可能になってはいけない | 🟢 |
| N-002-02 | 「希望しない」選択時に電話番号フィールドが入力可能になってはいけない | 🟢 |
| N-002-03 | 「メールでのご連絡」選択時に電話番号フィールドが有効化されてはいけない | 🟢 |
| N-002-04 | 「電話でのご連絡」選択時にメールアドレスフィールドが有効化されてはいけない | 🟢 |

---

## 信号サマリー

| 信号 | 件数 | 内容 |
|------|------|------|
| 🟢 | 49 | ページ表示4件、宿泊日入力5件、宿泊数・人数5件、オプション5件、合計金額4件、氏名2件、連絡方法5件、メール3件、電話4件、ご要望2件、送信制御2件、送信遷移4件、入力制限14件、誤有効化4件 |
| 🟡 | 1 | 過去日付入力の制限（Datepickerの設定詳細が未確認） |
| 🔴 | 0 | - |
