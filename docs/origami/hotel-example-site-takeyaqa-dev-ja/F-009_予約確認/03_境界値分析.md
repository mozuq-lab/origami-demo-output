# F-009 予約確認 境界値分析

## 基本情報

| 項目 | 内容 |
|------|------|
| 機能ID | F-009 |
| 機能名 | 予約確認 |
| 入力ファイル | 02_動作仕様.md |

---

## 境界値分析対象パラメータ

### BV-001: 合計金額（平日のみ宿泊）

週末割増なし・オプションなしの基本計算。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-001-01 | 合計金額（最小） | 素泊まり（5,500円）× 1泊 × 1人 = 5,500円（平日） | 5,500円と表示 | 🟢 | M-004-01 |
| BV-001-02 | 合計金額（プレミアムプラン最小） | 10,000円 × 1泊 × 2人 = 20,000円（平日・最小人数） | 20,000円と表示 | 🟢 | M-004-01 |
| BV-001-03 | 合計金額（最大試算） | テーマパーク優待（10,000円）× 5泊 × 9人 = 450,000円（平日・オプションなし） | 450,000円と表示 | 🟢 | M-004-01 |

### BV-002: 合計金額（週末割増）

土日を含む宿泊の割増計算。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-002-01 | 週末割増（土曜のみ1泊） | 5,500円 × 1人 × 1泊 + 5,500 × 1 × 0.25 = 6,875円 | 6,875円と表示 | 🟢 | M-004-02 |
| BV-002-02 | 週末割増（日曜のみ1泊） | 5,500円 × 1人 × 1泊 + 5,500 × 1 × 0.25 = 6,875円 | 6,875円と表示 | 🟢 | M-004-02 |
| BV-002-03 | 週末割増（土日をまたぐ2泊） | 5,500 × 1 × 2 + 5,500 × 1 × 0.25 × 2 = 13,750円 | 13,750円と表示 | 🟢 | M-004-02 |
| BV-002-04 | 週末割増なし（月〜金のみ） | 5,500 × 1 × 1 = 5,500円 | 5,500円と表示（割増なし） | 🟢 | M-004-02 |

### BV-003: オプション料金計算（朝食バイキング）

朝食バイキングは宿泊数×人数に比例。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-003-01 | 朝食バイキング選択なし | 加算なし | 基本料金のみ | 🟢 | M-004-03 |
| BV-003-02 | 朝食バイキング1泊1人 | 1,000 × 1人 × 1泊 = 1,000円加算 | 基本料金 + 1,000円 | 🟢 | M-004-03 |
| BV-003-03 | 朝食バイキング複数泊複数人 | 1,000 × 2人 × 3泊 = 6,000円加算 | 基本料金 + 6,000円 | 🟢 | M-004-03 |

### BV-004: オプション料金計算（昼からチェックインプラン）

昼からチェックインプランは人数のみ依存（宿泊数不問）。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-004-01 | 昼からチェックインなし | 加算なし | 基本料金のみ | 🟢 | M-004-04 |
| BV-004-02 | 昼からチェックイン1人 | 1,000 × 1人 = 1,000円加算（泊数問わず） | 基本料金 + 1,000円 | 🟡 | M-004-04 |
| BV-004-03 | 昼からチェックイン複数人 | 1,000 × 2人 = 2,000円加算（泊数問わず） | 基本料金 + 2,000円 | 🟡 | M-004-04 |

### BV-005: オプション料金計算（お得な観光プラン）

観光プランは人数のみ依存（宿泊数不問）。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-005-01 | 観光プランなし | 加算なし | 基本料金のみ | 🟢 | M-004-05 |
| BV-005-02 | 観光プラン1人 | 1,000 × 1人 = 1,000円加算（泊数問わず） | 基本料金 + 1,000円 | 🟡 | M-004-05 |
| BV-005-03 | 観光プラン複数人 | 1,000 × 2人 = 2,000円加算（泊数問わず） | 基本料金 + 2,000円 | 🟡 | M-004-05 |

### BV-006: 全オプション組み合わせ（合計金額への影響）

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-006-01 | オプション0個 | 基本料金のみ | オプション加算なし | 🟢 | M-004-03〜05 |
| BV-006-02 | 朝食のみ選択 | 1,000 × 人数 × 宿泊数 加算 | 正しく加算 | 🟢 | M-004-03 |
| BV-006-03 | 全3オプション選択（1泊1人） | 5,500 + 1,000 + 1,000 + 1,000 = 8,500円（平日） | 8,500円 | 🟡 | M-004-03〜05 |

### BV-007: 期間表示（チェックアウト日計算）

チェックアウト日 = チェックイン日 + 宿泊数。

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-007-01 | 宿泊数1泊 | チェックイン翌日がチェックアウト | 正しい日付範囲が表示される | 🟢 | M-003-01 |
| BV-007-02 | 月末をまたぐ宿泊 | 月末翌日（翌月1日）がチェックアウト | 月をまたいで正しく計算される | 🟡 | M-003-01 |
| BV-007-03 | 年末をまたぐ宿泊（12月31日チェックイン） | 翌年1月1日がチェックアウト | 年をまたいで正しく計算される | 🟡 | M-003-01 |

### BV-008: sessionStorage / Cookie の存在境界

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-008-01 | transaction Cookie あり + sessionStorage データあり | 通常表示 | 予約確認画面が正常表示される | 🟢 | M-001-02 |
| BV-008-02 | transaction Cookie なし | リダイレクト | /ja/index.html へリダイレクト | 🟢 | N-001-01 |
| BV-008-03 | transaction Cookie あり + sessionStorage データなし | リダイレクト | /ja/index.html へリダイレクト | 🟢 | N-001-02 |
| BV-008-04 | ページ表示後のリロード（データ削除済み） | リダイレクト | /ja/index.html へリダイレクト | 🟢 | N-001-03 |

### BV-009: ご要望テキストの境界

| No | パラメータ | 境界値 | 期待結果 | 信頼性 | 関連動作仕様 |
|----|-----------|--------|----------|--------|-------------|
| BV-009-01 | ご要望 空欄（空文字列） | 「なし」と表示 | 🟢 | M-003-10 |
| BV-009-02 | ご要望 140文字（最大） | 全文字が `<pre>` タグ内に表示 | 🟢 | M-003-09 |
| BV-009-03 | ご要望 改行を含むテキスト | `<pre>` タグにより改行が保持される | 🟢 | M-003-09 |

---

## 同値分割

### EP-001: 確認のご連絡の同値クラス

| クラス | 説明 | 代表値 | 期待結果 | 信頼性 |
|--------|------|--------|----------|--------|
| 希望しない | contact="no" | "no" | 「希望しない」と表示 | 🟢 |
| メール連絡 | contact="email" | email値あり | 「メール：{メールアドレス}」と表示 | 🟢 |
| 電話連絡 | contact="tel" | tel値あり | 「電話：{電話番号}」と表示 | 🟢 |

### EP-002: 追加プランの同値クラス

| クラス | 説明 | 代表値 | 期待結果 | 信頼性 |
|--------|------|--------|----------|--------|
| 全未選択 | 3オプションすべてfalse | すべてfalse | 「なし」と表示 | 🟢 |
| 一部選択 | いずれか1つ以上がtrue | 朝食のみ | `<ul><li>朝食バイキング</li></ul>` | 🟢 |
| 全選択 | 3オプションすべてtrue | すべてtrue | 3項目の `<ul>` リスト | 🟢 |

---

## 信号サマリー

| 信号 | 件数 | 内容 |
|------|------|------|
| 🟢 | 22 | 基本金額計算3件、週末割増4件、朝食バイキング3件、オプションなし2件、期間表示1件、Cookie/sessionStorage境界4件、ご要望3件、連絡方法3件、追加プラン3件 |
| 🟡 | 8 | 昼からチェックインプラン計算2件、観光プラン計算2件、全オプション計算1件、月末/年末またぎ日付2件、window.close()動作1件 |
| 🔴 | 0 | - |

---

## 備考

- 合計金額の週末割増（25%アップ）はconfirm.bundle.jsで実装。チェックイン日から宿泊数分の各日付の曜日を確認して加算
- 昼からチェックインプランとお得な観光プランの料金計算（宿泊数依存か否か）は🟡：reserve.htmlのプレビューでは「1,000円×宿泊数×人数」と表示されるが、confirm.bundle.jsでは「1,000円×人数」（宿泊数不問）の可能性あり
- ページリロード時のリダイレクトはデータの1回限り消費を保証するセキュリティ仕様
