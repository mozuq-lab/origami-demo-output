# F-009 予約確認 テストケース

## 基本情報

| 項目 | 内容 |
|------|------|
| 機能ID | F-009 |
| 機能名 | 予約確認 |
| 入力ファイル | 01_機能詳細.md + 02_動作仕様.md + 03_境界値分析.md |

---

## テストケース一覧

### グループ1: ページ表示・基本確認

---

#### TC-009-01: ページタイトルが正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-01 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-001-01 |

**Given（前提条件）:**

- reserve.htmlでフォームを正常に送信し、confirm.htmlに遷移した状態

**When（実行条件）:**

1. confirm.htmlをブラウザで開く

**Then（期待結果）:**

- [ ] ブラウザのタブタイトルが「宿泊予約確認 | HOTEL PLANISPHERE - テスト自動化練習サイト」であること

---

#### TC-009-02: 予約確認画面が正常表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-02 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-001-02, M-002-01〜03 |

**Given（前提条件）:**

- reserve.htmlでフォームを正常に送信し、sessionStorageにデータが保存され、transactionCookieが設定されている
- 素泊まりプラン（5,500円）、1泊、1人、平日（月〜金）チェックイン

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] h2見出しに「宿泊予約確認」が表示されること
- [ ] #total-billに「合計 5,500円（税込み）」と表示されること
- [ ] #plan-nameに「スタンダードツイン」等のプラン名が表示されること
- [ ] #plan-descに「お一人様1泊5,500円〜、土日は25%アップ」と表示されること

---

#### TC-009-03: プレミアムプランの予約データが正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-03 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-001-02, M-002-01〜03, M-003-01〜09 |

**Given（前提条件）:**

- プレミアムプラン（10,000円）、2泊、2人、平日チェックイン、追加オプションなし、連絡方法「メール」で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 40,000円（税込み）」と表示されること（10,000 × 2 × 2）
- [ ] #plan-nameに「プレミアムプラン」と表示されること
- [ ] 期間、人数、お名前、連絡方法が正しく表示されること

---

### グループ2: 合計金額計算

---

#### TC-009-04: 平日のみ宿泊（週末割増なし）の合計金額が正しいこと

| 項目 | 内容 |
|------|------|
| テストID | TC-009-04 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-004-01, BV-001-01 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、1泊、1人、月曜日チェックイン、オプションなし

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 5,500円（税込み）」と表示されること（週末割増なし）

---

#### TC-009-05: 土曜日チェックインで週末割増が加算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-05 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-004-02, BV-002-01 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、1泊、1人、土曜日チェックイン、オプションなし

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 6,875円（税込み）」と表示されること（5,500 + 5,500 × 0.25 = 6,875）

---

#### TC-009-06: 日曜日チェックインで週末割増が加算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-06 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-004-02, BV-002-02 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、1泊、1人、日曜日チェックイン、オプションなし

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 6,875円（税込み）」と表示されること

---

#### TC-009-07: 土日をまたぐ2泊で両日の週末割増が加算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-07 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-004-02, BV-002-03 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、2泊、1人、土曜日チェックイン（土曜・日曜に宿泊）、オプションなし

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 13,750円（税込み）」と表示されること（5,500 × 2 + 5,500 × 0.25 × 2 = 13,750）

---

#### TC-009-08: 朝食バイキング選択時に合計金額が正しく計算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-08 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-004-03, BV-003-03 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、2泊、2人、平日チェックイン、朝食バイキングのみ選択

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに「合計 26,000円（税込み）」と表示されること（5,500 × 2 × 2 + 1,000 × 2 × 2 = 26,000）

---

#### TC-009-09: 昼からチェックインプラン選択時の合計金額が計算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-09 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |
| 関連仕様 | M-004-04, BV-004-02 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、2泊、2人、平日チェックイン、昼からチェックインプランのみ選択

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに合計金額が表示されること
- [ ] 計算結果: confirm.bundle.jsのロジックに従い、「1,000 × 人数」が加算されること（宿泊数依存の有無を確認）

---

#### TC-009-10: お得な観光プラン選択時の合計金額が計算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-10 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |
| 関連仕様 | M-004-05, BV-005-02 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、2泊、2人、平日チェックイン、お得な観光プランのみ選択

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに合計金額が表示されること
- [ ] 計算結果: confirm.bundle.jsのロジックに従い、「1,000 × 人数」が加算されること（宿泊数依存の有無を確認）

---

#### TC-009-11: 全オプション選択時の合計金額が正しく計算されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-11 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |
| 関連仕様 | M-004-03〜05, BV-006-03 |

**Given（前提条件）:**

- 素泊まりプラン（5,500円）、1泊、1人、平日チェックイン、全3オプション選択

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #total-billに合計金額が表示されること（基本料金5,500 + 各オプション合算）
- [ ] 朝食：1,000 × 1 × 1 = 1,000円が加算されること

---

### グループ3: 表示項目確認

---

#### TC-009-12: 期間が「チェックイン日 〜 チェックアウト日 {泊数}泊」で表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-12 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-01, BV-007-01 |

**Given（前提条件）:**

- チェックイン日：2026年3月10日（火）、宿泊数：2泊

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #termに「2026年3月10日 〜 2026年3月12日 2泊」と表示されること

---

#### TC-009-13: 人数が「{人数}名様」で表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-13 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-02 |

**Given（前提条件）:**

- 人数：3人で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #head-countに「3名様」と表示されること

---

#### TC-009-14: 追加プランを選択した場合リスト表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-14 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-03 |

**Given（前提条件）:**

- 朝食バイキングと昼からチェックインプランを選択して予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #plansに `<ul>` リストで「朝食バイキング」「昼からチェックインプラン」が表示されること

---

#### TC-009-15: 追加プランを選択していない場合「なし」と表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-15 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-04 |

**Given（前提条件）:**

- 追加プランを選択せずに予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #plansに「なし」と表示されること

---

#### TC-009-16: お名前が「{氏名}様」で表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-16 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-05 |

**Given（前提条件）:**

- 氏名「山田太郎」で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #usernameに「山田太郎様」と表示されること

---

#### TC-009-17: 確認のご連絡「希望しない」が正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-17 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-06 |

**Given（前提条件）:**

- 連絡方法「希望しない」で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #contactに「希望しない」と表示されること

---

#### TC-009-18: 確認のご連絡「メール」が正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-18 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-07 |

**Given（前提条件）:**

- 連絡方法「メールでのご連絡」、メールアドレス「test@example.com」で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #contactに「メール：test@example.com」と表示されること

---

#### TC-009-19: 確認のご連絡「電話」が正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-19 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-08 |

**Given（前提条件）:**

- 連絡方法「電話でのご連絡」、電話番号「09012345678」で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #contactに「電話：09012345678」と表示されること

---

#### TC-009-20: ご要望テキストが表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-20 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-09, BV-009-02 |

**Given（前提条件）:**

- ご要望「アレルギーがあります。\n卵はNGです。」（改行含む）で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] pre#commentに入力テキストが表示されること
- [ ] 改行が保持されて表示されること（`<pre>` タグによる改行保持）

---

#### TC-009-21: ご要望が空欄の場合「なし」と表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-21 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-003-10, BV-009-01 |

**Given（前提条件）:**

- ご要望未入力で予約入力済み

**When（実行条件）:**

1. confirm.htmlが表示される

**Then（期待結果）:**

- [ ] #commentに「なし」と表示されること

---

### グループ4: 予約確定ボタン・モーダル

---

#### TC-009-22: 「この内容で予約する」ボタンが表示され常にクリック可能であること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-22 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-005-01 |

**Given（前提条件）:**

- 予約データが表示された confirm.html を開いている

**When（実行条件）:**

1. ページを確認する

**Then（期待結果）:**

- [ ] 「この内容で予約する」ボタンが表示されること
- [ ] ボタンが有効（disabled でない）であること

---

#### TC-009-23: 「この内容で予約する」ボタンクリックでモーダルが表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-23 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-005-02, M-005-03 |

**Given（前提条件）:**

- 予約データが表示された confirm.html を開いている

**When（実行条件）:**

1. 「この内容で予約する」ボタンをクリックする

**Then（期待結果）:**

- [ ] #success-modal が表示されること
- [ ] フェードアニメーションでモーダルが表示されること

---

#### TC-009-24: モーダルのタイトルと本文が正しく表示されること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-24 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-006-01, M-006-02 |

**Given（前提条件）:**

- 「この内容で予約する」ボタンをクリックして #success-modal が表示された状態

**When（実行条件）:**

1. モーダルの内容を確認する

**Then（期待結果）:**

- [ ] モーダルのタイトルが「予約を完了しました」であること
- [ ] モーダルの本文が「ご来館、心よりお待ちしております。」であること
- [ ] 緑色の「閉じる」ボタンが表示されること
- [ ] ヘッダーの「×」ボタンが表示されること

---

#### TC-009-25: モーダル「閉じる」ボタンでモーダルが閉じること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-25 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-006-05, M-006-07 |

**Given（前提条件）:**

- #success-modal が表示された状態

**When（実行条件）:**

1. フッターの「閉じる」ボタンをクリックする

**Then（期待結果）:**

- [ ] モーダルが閉じること
- [ ] `window.close()` が実行されること（タブが閉じるか、閉じない場合は空の確認画面が残る）

---

#### TC-009-26: モーダルヘッダー「×」ボタンでモーダルが閉じること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-26 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | M-006-06, M-006-07 |

**Given（前提条件）:**

- #success-modal が表示された状態

**When（実行条件）:**

1. ヘッダーの「×」ボタンをクリックする

**Then（期待結果）:**

- [ ] モーダルが閉じること
- [ ] `window.close()` が実行されること

---

#### TC-009-27: モーダル外クリックでモーダルが閉じないこと（static backdrop）

| 項目 | 内容 |
|------|------|
| テストID | TC-009-27 |
| テスト種別 | 異常系 |
| 信号 | 🟢 |
| 関連仕様 | N-002-01 |

**Given（前提条件）:**

- #success-modal が表示された状態

**When（実行条件）:**

1. モーダルの背景（オーバーレイ部分）をクリックする

**Then（期待結果）:**

- [ ] モーダルが閉じないこと（data-backdrop="static" による制御）

---

### グループ5: データ管理・セキュリティ

---

#### TC-009-28: transaction Cookie なしで直接アクセスするとトップページへリダイレクトされること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-28 |
| テスト種別 | 異常系 |
| 信号 | 🟢 |
| 関連仕様 | N-001-01, BV-008-02 |

**Given（前提条件）:**

- ブラウザに `transaction` Cookie が存在しない状態

**When（実行条件）:**

1. /ja/confirm.html に直接アクセスする

**Then（期待結果）:**

- [ ] /ja/index.html へリダイレクトされること
- [ ] 予約確認画面が表示されないこと

---

#### TC-009-29: sessionStorage にデータなしで直接アクセスするとトップページへリダイレクトされること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-29 |
| テスト種別 | 異常系 |
| 信号 | 🟢 |
| 関連仕様 | N-001-02, BV-008-03 |

**Given（前提条件）:**

- `transaction` Cookie は存在するが、該当する sessionStorage キーのデータが存在しない状態

**When（実行条件）:**

1. /ja/confirm.html にアクセスする

**Then（期待結果）:**

- [ ] /ja/index.html へリダイレクトされること

---

#### TC-009-30: ページ表示後にリロードするとトップページへリダイレクトされること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-30 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | N-001-03, N-003-01, N-003-02, BV-008-04 |

**Given（前提条件）:**

- 予約データが正常に表示された confirm.html の状態（初回ロード済み）

**When（実行条件）:**

1. ブラウザのリロードボタンをクリックする

**Then（期待結果）:**

- [ ] /ja/index.html へリダイレクトされること（sessionStorage + Cookie は初回ロード時に削除済み）
- [ ] 予約データが再表示されないこと

---

#### TC-009-31: ページ表示後に sessionStorage が削除されていること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-31 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | N-003-01, M-001-04 |

**Given（前提条件）:**

- 予約データが sessionStorage に保存され、confirm.html が表示された状態

**When（実行条件）:**

1. confirm.html のページ表示後、ブラウザの開発ツールで sessionStorage を確認する

**Then（期待結果）:**

- [ ] sessionStorage に予約データが残っていないこと（transaction キーに対するエントリが削除されていること）

---

#### TC-009-32: ページ表示後に transaction Cookie が削除されていること

| 項目 | 内容 |
|------|------|
| テストID | TC-009-32 |
| テスト種別 | 正常系 |
| 信号 | 🟢 |
| 関連仕様 | N-003-02, M-001-03 |

**Given（前提条件）:**

- `transaction` Cookie が設定された状態で confirm.html が表示された後

**When（実行条件）:**

1. ページ表示後にブラウザの開発ツールで Cookie を確認する

**Then（期待結果）:**

- [ ] `transaction` Cookie が存在しないこと（max-age=0 により削除済み）

---

## テストケース数サマリー

| グループ | テストケース数 |
|---------|--------------|
| グループ1: ページ表示・基本確認 | 3件（TC-009-01〜03） |
| グループ2: 合計金額計算 | 8件（TC-009-04〜11） |
| グループ3: 表示項目確認 | 10件（TC-009-12〜21） |
| グループ4: 予約確定ボタン・モーダル | 6件（TC-009-22〜27） |
| グループ5: データ管理・セキュリティ | 5件（TC-009-28〜32） |
| **合計** | **32件** |

## 信号サマリー

| 信号 | 件数 | 内容 |
|------|------|------|
| 🟢 | 29 | ページ表示3件、基本金額計算4件、週末割増2件、朝食1件、表示項目10件、モーダル6件、データ管理5件、リダイレクト3件 |
| 🟡 | 3 | 昼からチェックインプラン合計金額計算、観光プラン合計金額計算、全オプション合計（宿泊数依存性が要確認） |
| 🔴 | 0 | - |
