# 観点レビュー: F-002 ログアウト

## 生成情報

- 生成日時: 2026-02-23 00:00
- 入力ソース: 04_テストケース.md, 01_機能詳細.md
- 参照カタログ: テスト観点カタログ v1.6（TIS株式会社, CC BY-SA 4.0）
- アプリ種別: web
- 対象機能: F-002 ログアウト
- 総観点数: 203件（対象: 23件 / 対象外: 180件）
- 信号分布: 🟢 10件 / 🟡 10件 / 🔴 3件

---

## カバレッジサマリー

| セクション | 対象観点数 | 🟢 カバー済 | 🟡 未カバー推奨 | 🔴 要確認 | カバー率 |
|-----------|-----------|------------|----------------|----------|---------|
| バリデーション（VAL） | 2 | 2 | 0 | 0 | 100% |
| ウェブアプリケーション（WEB） | 9 | 6 | 3 | 0 | 67% |
| セキュリティ共通（SEC-C） | 5 | 2 | 2 | 1 | 40% |
| セキュリティウェブ（SEC-W） | 4 | 0 | 2 | 2 | 0% |
| ユーザビリティ（USA） | 3 | 0 | 3 | 0 | 0% |
| **合計** | **23** | **10** | **10** | **3** | **43%** |

---

## 🟢 カバー済み観点

| # | 観点ID | 観点名 | 対応テストケース | カテゴリ |
|---|--------|--------|----------------|---------|
| 1 | VP-VAL-006 | 状態遷移の妥当性チェック | TC-002-01, TC-002-02 | バリデーション |
| 2 | VP-VAL-007 | データ整合性チェック | TC-002-05, TC-002-06 | バリデーション |
| 3 | VP-WEB-001 | 画面遷移の正確性 | TC-002-07 | ウェブアプリケーション |
| 4 | VP-WEB-002 | ナビゲーション表示の整合性 | TC-002-05, TC-002-06 | ウェブアプリケーション |
| 5 | VP-WEB-003 | リンク動作の正確性 | TC-002-01, TC-002-03, TC-002-04 | ウェブアプリケーション |
| 6 | VP-WEB-007 | ページ遷移後の状態維持 | TC-002-09 | ウェブアプリケーション |
| 7 | VP-WEB-008 | Cookie管理 | TC-002-08 | ウェブアプリケーション |
| 8 | VP-WEB-009 | セッション管理 | TC-002-08, TC-002-09 | ウェブアプリケーション |
| 9 | VP-SEC-C-001 | 認証状態管理 | TC-002-03, TC-002-04, TC-002-10, TC-002-11 | セキュリティ共通 |
| 10 | VP-SEC-C-002 | セッション無効化 | TC-002-08, TC-002-09 | セキュリティ共通 |

---

## 🟡 未カバー推奨観点

| # | 観点ID | 観点名 | 推奨理由 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-WEB-004 | ブラウザバック操作 | ログアウト後にブラウザバックでログイン状態のページに戻れる可能性がある | ウェブアプリケーション |
| 2 | VP-WEB-005 | マルチタブ・マルチウィンドウ | 複数タブで同一サイトを開いている場合、一方でログアウトした際の他方の挙動を確認すべき | ウェブアプリケーション |
| 3 | VP-WEB-006 | 直接URL入力 | ログアウト後にマイページ等の保護ページURLを直接入力した場合の挙動を確認すべき | ウェブアプリケーション |
| 4 | VP-SEC-C-003 | Cookie属性の安全性 | 認証CookieのHttpOnly、Secure、SameSite属性が適切に設定されているか確認すべき | セキュリティ共通 |
| 5 | VP-SEC-C-005 | エラーハンドリング | ログアウト処理中にエラーが発生した場合の挙動を確認すべき | セキュリティ共通 |
| 6 | VP-SEC-W-001 | キャッシュ制御ヘッダー | ログアウト後にブラウザキャッシュから認証済みページが表示されないことを確認すべき | セキュリティウェブ |
| 7 | VP-SEC-W-002 | セッション固定攻撃防止 | ログアウト→再ログイン時にセッションIDが再生成されることを確認すべき | セキュリティウェブ |
| 8 | VP-USA-001 | 操作フィードバック | ログアウト完了時にユーザーへ適切なフィードバック（メッセージ等）が表示されるか確認すべき | ユーザビリティ |
| 9 | VP-USA-002 | アクセシビリティ | ログアウトリンクのaria属性やスクリーンリーダー対応を確認すべき | ユーザビリティ |
| 10 | VP-USA-003 | キーボード操作 | Tabキーでのフォーカス移動やEnterキーでのログアウト実行が可能か確認すべき | ユーザビリティ |

---

## 🔴 要確認観点

| # | 観点ID | 観点名 | 確認内容 | カテゴリ |
|---|--------|--------|---------|---------|
| 1 | VP-SEC-C-004 | ログ・監査証跡 | クライアントサイドのみの実装であるため、ログアウト操作の監査ログが必要かどうかステークホルダーに確認が必要 | セキュリティ共通 |
| 2 | VP-SEC-W-003 | ログアウトCSRF | ログアウト処理にCSRFトークン保護が必要かどうか。悪意あるサイトからのログアウト強制の影響度をステークホルダーに確認が必要 | セキュリティウェブ |
| 3 | VP-SEC-W-004 | クリックジャッキング防止 | ログアウトリンクがiframe内に埋め込まれて不正クリックされるリスクの有無をステークホルダーに確認が必要 | セキュリティウェブ |

---

## 補完テストケース案

🟡項目に対する補完テストケース案を以下に示します。

### STC-002-01: ログアウト後にブラウザバックでログイン状態に戻らないこと

| 項目 | 内容 |
|------|------|
| テストID | STC-002-01 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-WEB-004 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザー（ichiro@example.com / password）でログイン済み

**When（実行条件）:**

1. ナビゲーションの「ログアウト」リンクをクリックする
2. ログアウトが完了したことを確認する
3. ブラウザの「戻る」ボタンをクリックする

**Then（期待結果）:**

- [ ] ブラウザバック後もログイン状態に戻らないこと
- [ ] ナビゲーションが未ログイン状態（ホーム、宿泊予約、会員登録、ログイン）のままであること

**根拠:** テスト観点カタログ VP-WEB-004 に基づく補完

---

### STC-002-02: 複数タブでログアウトした場合の他タブへの影響

| 項目 | 内容 |
|------|------|
| テストID | STC-002-02 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-WEB-005 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み
- 同一ブラウザで2つのタブでサイトを開いている

**When（実行条件）:**

1. タブAでナビゲーションの「ログアウト」リンクをクリックする
2. タブBでページをリロードする

**Then（期待結果）:**

- [ ] タブBでも未ログイン状態のナビゲーションが表示されること
- [ ] タブBでログイン済みの情報が表示されないこと

**根拠:** テスト観点カタログ VP-WEB-005 に基づく補完

---

### STC-002-03: ログアウト後にマイページURLを直接入力した場合の挙動

| 項目 | 内容 |
|------|------|
| テストID | STC-002-03 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-WEB-006 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン後、ログアウト済み

**When（実行条件）:**

1. ブラウザのアドレスバーにマイページのURL（mypage.html）を直接入力する
2. Enterキーを押す

**Then（期待結果）:**

- [ ] マイページにアクセスできないこと（ログインページへリダイレクト、またはエラー表示）
- [ ] ログイン済みユーザーの個人情報が表示されないこと

**根拠:** テスト観点カタログ VP-WEB-006 に基づく補完

---

### STC-002-04: 認証CookieのHttpOnly・Secure・SameSite属性の確認

| 項目 | 内容 |
|------|------|
| テストID | STC-002-04 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-SEC-C-003 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み

**When（実行条件）:**

1. ブラウザの開発者ツールでCookieの属性を確認する
2. ナビゲーションの「ログアウト」リンクをクリックする
3. ログアウト後のCookie状態を確認する

**Then（期待結果）:**

- [ ] ログイン時の認証CookieにHttpOnly属性が設定されていること
- [ ] 認証CookieにSecure属性が設定されていること（HTTPS環境の場合）
- [ ] 認証CookieにSameSite属性が適切に設定されていること
- [ ] ログアウト後に認証Cookieが完全に削除されていること

**根拠:** テスト観点カタログ VP-SEC-C-003 に基づく補完

---

### STC-002-05: ログアウト処理のエラーハンドリング

| 項目 | 内容 |
|------|------|
| テストID | STC-002-05 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-SEC-C-005 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み
- ブラウザのCookieが手動で破損・改ざんされている状態

**When（実行条件）:**

1. ブラウザの開発者ツールで認証Cookieの値を不正な値に書き換える
2. ナビゲーションの「ログアウト」リンクをクリックする

**Then（期待結果）:**

- [ ] エラーが発生せず、安全にログアウト処理が完了すること
- [ ] 未ログイン状態のナビゲーションが正しく表示されること

**根拠:** テスト観点カタログ VP-SEC-C-005 に基づく補完

---

### STC-002-06: ログアウト後のキャッシュ制御による情報漏洩防止

| 項目 | 内容 |
|------|------|
| テストID | STC-002-06 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-SEC-W-001 |
| テスト種別 | 異常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログインし、マイページを閲覧済み
- ログアウト済み

**When（実行条件）:**

1. ブラウザの「戻る」ボタンを複数回クリックしてマイページのキャッシュ表示を試みる
2. ブラウザのアドレスバーにマイページURLを入力する

**Then（期待結果）:**

- [ ] キャッシュからログイン済みユーザーの個人情報が表示されないこと
- [ ] Cache-Control ヘッダーが no-store または no-cache に設定されていること（開発者ツールで確認）

**根拠:** テスト観点カタログ VP-SEC-W-001 に基づく補完

---

### STC-002-07: ログアウト→再ログイン時のセッションID再生成

| 項目 | 内容 |
|------|------|
| テストID | STC-002-07 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-SEC-W-002 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み
- ログイン時のCookie値を記録している

**When（実行条件）:**

1. ブラウザの開発者ツールで現在の認証Cookie値を記録する
2. ナビゲーションの「ログアウト」リンクをクリックする
3. 同じユーザーで再度ログインする
4. 再ログイン後のCookie値を記録する

**Then（期待結果）:**

- [ ] 再ログイン後のCookie値がログアウト前と異なること（セッションIDが再生成されていること）

**根拠:** テスト観点カタログ VP-SEC-W-002 に基づく補完

---

### STC-002-08: ログアウト完了時のフィードバック表示

| 項目 | 内容 |
|------|------|
| テストID | STC-002-08 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-USA-001 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み

**When（実行条件）:**

1. ナビゲーションの「ログアウト」リンクをクリックする
2. 画面表示を確認する

**Then（期待結果）:**

- [ ] ログアウト完了がユーザーに伝わる表示があること（ナビゲーション変化、ページ遷移、メッセージのいずれか）
- [ ] ログアウト後の画面がユーザーにとって混乱しない表示であること

**根拠:** テスト観点カタログ VP-USA-001 に基づく補完

---

### STC-002-09: ログアウトリンクのアクセシビリティ対応

| 項目 | 内容 |
|------|------|
| テストID | STC-002-09 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-USA-002 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み

**When（実行条件）:**

1. スクリーンリーダーでナビゲーションメニューを読み上げさせる
2. ログアウトリンクのaria属性を開発者ツールで確認する

**Then（期待結果）:**

- [ ] 「ログアウト」リンクがスクリーンリーダーで正しく読み上げられること
- [ ] リンクのrole属性やaria-label属性が適切に設定されていること
- [ ] フォーカス時に視覚的なフォーカスインジケーターが表示されること

**根拠:** テスト観点カタログ VP-USA-002 に基づく補完

---

### STC-002-10: キーボードによるログアウト操作

| 項目 | 内容 |
|------|------|
| テストID | STC-002-10 |
| 対象機能 | F-002: ログアウト |
| 対応観点 | VP-USA-003 |
| テスト種別 | 正常系 |
| 信号 | 🟡 |

**Given（前提条件）:**

- 登録済みユーザーでログイン済み

**When（実行条件）:**

1. Tabキーでナビゲーションメニューの「ログアウト」リンクにフォーカスを移動する
2. Enterキーを押す

**Then（期待結果）:**

- [ ] Tabキーで「ログアウト」リンクにフォーカスが移動できること
- [ ] Enterキーでログアウト処理が実行されること
- [ ] ログアウト後に未ログイン状態のナビゲーションが表示されること

**根拠:** テスト観点カタログ VP-USA-003 に基づく補完

---

## 優先対応一覧

| # | 観点ID | 観点名 | 対応方針 | 信号 |
|---|--------|--------|---------|------|
| 1 | VP-WEB-004 | ブラウザバック操作 | 補完テストケース案あり（STC-002-01） | 🟡 |
| 2 | VP-WEB-005 | マルチタブ・マルチウィンドウ | 補完テストケース案あり（STC-002-02） | 🟡 |
| 3 | VP-WEB-006 | 直接URL入力 | 補完テストケース案あり（STC-002-03） | 🟡 |
| 4 | VP-SEC-C-003 | Cookie属性の安全性 | 補完テストケース案あり（STC-002-04） | 🟡 |
| 5 | VP-SEC-C-004 | ログ・監査証跡 | ステークホルダー確認 | 🔴 |
| 6 | VP-SEC-C-005 | エラーハンドリング | 補完テストケース案あり（STC-002-05） | 🟡 |
| 7 | VP-SEC-W-001 | キャッシュ制御ヘッダー | 補完テストケース案あり（STC-002-06） | 🟡 |
| 8 | VP-SEC-W-002 | セッション固定攻撃防止 | 補完テストケース案あり（STC-002-07） | 🟡 |
| 9 | VP-SEC-W-003 | ログアウトCSRF | ステークホルダー確認 | 🔴 |
| 10 | VP-SEC-W-004 | クリックジャッキング防止 | ステークホルダー確認 | 🔴 |
| 11 | VP-USA-001 | 操作フィードバック | 補完テストケース案あり（STC-002-08） | 🟡 |
| 12 | VP-USA-002 | アクセシビリティ | 補完テストケース案あり（STC-002-09） | 🟡 |
| 13 | VP-USA-003 | キーボード操作 | 補完テストケース案あり（STC-002-10） | 🟡 |

---

## 参照カタログ情報

- **原典**: テスト観点カタログ v1.6
- **著作者**: TIS株式会社
- **ライセンス**: CC BY-SA 4.0 (Creative Commons Attribution-ShareAlike 4.0 International)
- **抽出範囲**: ブラックボックステスト関連項目（5セクション、203項目）
- **適用セクション**: VAL（バリデーション）、WEB（ウェブアプリケーション）、SEC-C（セキュリティ共通）、SEC-W（セキュリティウェブ）、USA（ユーザビリティ）

---

## 次のステップ

### 補完テストケースの反映

🟡項目の補完テストケース案を既存のテストケースに反映するには:

1. **手動追記**: `04_テストケース.md` に補完テストケース案をコピーして追記
2. **再生成**: 動作仕様（`02_動作仕様.md`）に観点を追加した上で、`/origami:generate-cases` を再実行

### 確認事項

- 🔴項目（3件: ログ・監査証跡、ログアウトCSRF、クリックジャッキング防止）についてステークホルダーに確認
- 🟡項目の補完テストケース案（10件）の妥当性を確認
- 全STCを反映した場合のカバレッジ: 43% → 87%（目標70%を達成可能）
- カバレッジ目標（推奨: 🟢 70%以上）の達成状況を確認
